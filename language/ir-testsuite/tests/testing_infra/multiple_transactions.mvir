//! account: alice, 900000
//! account: bob, 900000

// Alice sends 200 Diem Coins to Bob
//! sender: alice
//! args: {{bob}}
//! gas-price: 0

import 0x1.DiemAccount;
import 0x1.Coin1;
import 0x1.Diem;

main(account: &signer, receiver: address) {
    let coins: Diem.Diem<Coin1.Coin1>;
    let with_cap: DiemAccount.WithdrawCapability;

    with_cap = DiemAccount.extract_withdraw_capability(copy(account));
    DiemAccount.pay_from<Coin1.Coin1>(&with_cap, move(receiver), 200, h"", h"");
    DiemAccount.restore_withdraw_capability(move(with_cap));

    return;
}



// Alice checks that her balance is less than 999800 Diem Coins. (200 + gas)
//! new-transaction
//! sender: alice

import 0x1.DiemAccount;
import 0x1.Coin1;
import 0x1.Signer;

main(account: &signer) {
    let balance: u64;
    let sender: address;

    sender = Signer.address_of(move(account));
    balance = DiemAccount.balance<Coin1.Coin1>(move(sender));
    assert(move(balance) <= 999800, 42);

    return;
}



// Bob checks that he has 90200 Diem Coins
//! new-transaction
//! sender: bob
import 0x1.DiemAccount;
import 0x1.Coin1;
import 0x1.Signer;

main(account: &signer) {
    let balance: u64;
    let sender: address;

    sender = Signer.address_of(move(account));
    balance = DiemAccount.balance<Coin1.Coin1>(move(sender));
    assert(move(balance) == 900200, 42);

    return;
}
